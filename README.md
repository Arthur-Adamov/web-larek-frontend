# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Данные и типы данных, используемые в приложении

Карточка

```ts
interface ICard {
    cardID: string;
    category?: string;
    title: string;
    image?: string;
    description?: string;
    price: number;
}
```

Заказ

```ts
interface IOrder {
    cardItems: ICard[];
    totalPrice: number;
    paymentMethod: string;
    address: string;
    email: string;
    tel: string;
}
```

Данные карточки, используемые на главной странице
```ts
type TCardPublicInfo = Pick<ICard, 'category' | 'title' | 'image' | 'price'>
```

Данные карточки, используемые в попапе карточки
```ts
type TCardInfo = Pick<ICard, 'image' | 'category' | 'title' | 'description' | 'price'>
```

Данные карточки и заказа, используемые в корзине
```ts
type TBasket = Pick<ICard & IOrder, 'title' | 'price' | 'totalPrice'>
```

Данные заказа, используемые в попапах ввода данных покупателя
```ts
type TOrderInfo = Pick<IOrder, 'paymentMethod' | 'address' | 'email' | 'phone'>
```

## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP: 
- слой предствления отвечает за отображение данных на странице,
- слой данных овечает за хранение и изменение данных,
- презентер отвечает за связь представления и данных.

### Базовый код

#### Класс Api

Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов. Методы:

- `get` - выполняет GET-запрос на переданный в параметрах эндпоинт и возвращает промис с объектом с заголовками запросов.
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса и отправляет эти данные на эндпоинт, переданный как параметр, при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса можкт быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter

Брокер событий позволяет отправлять события и подписываться на события, происхояшие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.
Основные методы, реализуемые классов описаны интерфейсом `IEvents`:
- `on` - подписка на событие
- `off` - снятие обработчика с события
- `emit` - инициализация события
- `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие

### Слой данных

#### Класс CardsData

Класс отвечает за хранение и логику работы с данными карточек товаров.\
Конструктор класса принимает инстант брокера событий.\
В полях класса хранятся следующие данные:
- cards:ICard[] - массив объектов карточек
- preview: string | null - id карточки, выбранной для просмотра в модальном окне
- events: IEvents - экземпляр класса `EventEmitter` для инициализации событий при изменении данных

Так же класс предоставляет набор методов для взаимодействия с этими данными:
- addCard(card: ICard): void - добавляет карточку в начало массива
- getCard(cardID: string): ICard - возвращает карточку по ее id

#### Класс BasketData

Класс отвечает за хранение и логику работы с карточками товаров в корзине.\
Конструктор класса принимает инстант брокера событий.\
В поле класса имееются след дынные:
- cards:TBasket[] - массив объектов карточек

Так же класс предоставляет набор методов для взаимодействия с этими данными:
- addCard(card: ICard): void - добавляет товар в начало списка
- deleteCard(cardID: string): void - удаляет товар из списка

#### Класс OrderData

Класс отвечает за храниение информации и логику работы заказа.

- paymentMethod: string - выбор метода оплаты
- address: string - адрес покупателя
- email: string - Email покупателя
- phone: string - номер телефона покупателя

Так же класс предоставляет метод для взаимодействия с этими данными:
- setOrderInfo(orderData: TOrderInfo): void - сохраняет данные покупателя в классе

### Классы представления

Все классы представления отвечают за отображение внутри контейнера (DOM-элемент) передаваемых в них данных.